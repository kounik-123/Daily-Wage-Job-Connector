<div class="d-flex justify-content-between align-items-center mb-3">
  <h3 class="mb-0">User Dashboard</h3>
  <div class="d-flex align-items-center gap-2">
    <input class="form-control form-control-sm" style="width: 240px" type="search" placeholder="Search my jobs..." onkeydown="if(event.key==='Enter'){window.location='/jobs/active?q='+encodeURIComponent(this.value)}" />
    <a href="/notifications" class="btn btn-light btn-sm" title="Notifications"><i class="bi bi-bell"></i></a>
    <a href="/settings" class="btn btn-light btn-sm" title="Settings"><i class="bi bi-gear"></i></a>
  </div>
</div>

<div class="row g-3">
  <div class="col-12">
    <div class="row g-3">
      <div class="col-6 col-md-3">
        <div class="card shadow-sm text-center">
          <div class="card-body">
            <div class="d-flex justify-content-center align-items-center mb-2">
              <div class="rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width:34px;height:34px;background:#dbeafe;color:#1d4ed8;">
                <i class="bi bi-clipboard-check"></i>
              </div>
              <div class="text-muted small">Total Jobs Posted</div>
            </div>
            <div class="fs-4 fw-bold"><%= stats.totalJobsPosted %></div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card shadow-sm text-center">
          <div class="card-body">
            <div class="d-flex justify-content-center align-items-center mb-2">
              <div class="rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width:34px;height:34px;background:#ffedd5;color:#c2410c;">
                <i class="bi bi-hourglass-split"></i>
              </div>
              <div class="text-muted small">Jobs in Progress</div>
            </div>
            <div class="fs-4 fw-bold"><%= stats.jobsInProgress %></div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card shadow-sm text-center">
          <div class="card-body">
            <div class="d-flex justify-content-center align-items-center mb-2">
              <div class="rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width:34px;height:34px;background:#dcfce7;color:#15803d;">
                <i class="bi bi-cash-coin"></i>
              </div>
              <div class="text-muted small">Total Paid</div>
            </div>
            <div class="fs-4 fw-bold">₹<%= stats.totalPaid %></div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card shadow-sm text-center">
          <div class="card-body">
            <div class="d-flex justify-content-center align-items-center mb-2">
              <div class="rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width:34px;height:34px;background:#fee2e2;color:#b91c1c;">
                <i class="bi bi-exclamation-circle"></i>
              </div>
              <div class="text-muted small">Pending Payments</div>
            </div>
            <div class="fs-4 fw-bold">₹<%= stats.pendingPayments %></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-6">
    <div class="card shadow-sm h-100">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h6 class="mb-0">Recent Applicants</h6>
          <a class="small" href="/jobs/active">View all</a>
        </div>
        <div class="list-group list-group-flush">
          <% if (!recentApplicants || !recentApplicants.length) { %>
            <div class="text-muted small">No recent applicants.</div>
          <% } %>
          <% recentApplicants.forEach(a => { %>
            <div class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <div class="fw-semibold"><%= a.name %></div>
                <div class="text-muted small">Applied for: <%= a.jobTitle %></div>
              </div>
              <% if (a.email) { %>
                <a href="mailto:<%= a.email %>" class="btn btn-sm btn-outline-primary">Contact</a>
              <% } %>
            </div>
          <% }) %>
        </div>
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-6">
    <div class="card shadow-sm h-100">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h6 class="mb-0">Active Job Posts</h6>
          <a class="small" href="/jobs/active">Manage</a>
        </div>
        <div class="row g-2">
          <% if (!activeJobPosts || !activeJobPosts.length) { %>
            <div class="col-12"><div class="text-muted small">No active posts.</div></div>
          <% } %>
          <% activeJobPosts.forEach(j => { %>
            <div class="col-12">
              <div class="card job-card">
                <div class="card-body d-flex justify-content-between align-items-center">
                  <div>
                    <div class="fw-semibold"><%= j.title %></div>
                    <div class="text-muted small text-uppercase"><%= j.status %></div>
                  </div>
                  <div class="d-flex gap-2">
                    <a href="/jobs/<%= j._id %>/edit" class="btn btn-sm btn-outline-secondary">Edit</a>
                    <form method="post" action="/jobs/<%= j._id %>/delete" data-confirm="Delete this job? This cannot be undone.">
                      <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          <% }) %>
        </div>
      </div>
    </div>
  </div>

  <div class="col-12">
    <div class="card shadow-sm mt-3">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h6 class="mb-0">Payment Summary</h6>
          <a class="small" href="/wallet">Wallet</a>
        </div>
        <div class="row g-3">
          <div class="col-6 col-md-3">
            <div class="p-3 rounded wallet-earnings">
              <div class="small">Paid</div>
              <div class="fs-5 fw-bold">₹<%= stats.totalPaid %></div>
            </div>
          </div>
          <div class="col-6 col-md-3">
            <div class="p-3 rounded wallet-pending">
              <div class="small">Pending</div>
              <div class="fs-5 fw-bold">₹<%= stats.pendingPayments %></div>
            </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="p-3 border rounded">
              <div class="small text-muted">Notes</div>
              <div class="small">Track your payments and manage invoices in the Wallet section.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
